<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="styles/all.css" media="all"/>
</head>

<body>
  <script type="text/javascript">
    var json = require("set_jsons/legend_of_blue_eyes_white_dragon.json");
    const set_list = ["legend_of_blue_eyes_white_dragon", "metal_raiders"]
    var drafted_cards = new Set([]);
    var number_drafted = 0;

    function get_pack(cardlist, n){
      var pack_cards = [];

      var common_cards_array = Array.from(common_cards);

      for (i = 0; i < n; i++) {
        var pack_card = common_cards_array[Math.floor(Math.random() * common_cards_array.length)];
        // Reroll the card if it's already in the pack.
        while (pack_cards.includes(pack_card)) {
          pack_card = common_cards_array[Math.floor(Math.random() * common_cards_array.length)];
        }
        pack_cards.push(pack_card);
      }

      return pack_cards;
    }

    function display_card_image(cardname, draft=false){
      var x = document.createElement("IMG");
      x.setAttribute("src", "card_images/".concat(cardname).concat(".jpg"));
      x.setAttribute("alt", cardname);
      x.setAttribute("height", 312);
      x.setAttribute("width", 210);
      if (draft) {
        x.setAttribute("class", "pack")
        x.setAttribute("onclick", "draft('".concat(cardname).concat("')"));
        document.body.insertBefore(x, document.getElementById("break"));
      }
      else {
        document.body.appendChild(x);
      }
    }

    function draft(cardname){
      // Update number of cards drafted
      number_drafted++;
      document.getElementById("deckHeader").innerHTML = "Drafted Cards (".concat(number_drafted.toString()).concat("/40)")

      drafted_cards.add(cardname);
      display_card_image(cardname);

      for (pack_card_img of document.getElementsByClassName("pack")) {
        pack_card_img.setAttribute("hidden", "");
      }


      if (number_drafted < 87) {
        for (pack_card of get_pack(common_cards, 9)) {
        display_card_image(pack_card, true);
        }
      }
    }

    for (set of get_pack(set_list[number_drafted], 9)) {
        display_card_image(pack_card, true);
    }

  </script>
  <br id="break"></br>
  <h1 id="deckHeader">Drafted Cards (0/87)</h1>

</body>

</html>
